stages:
  - unit_tests
  - build

variables:
  LC_ALL: "en_US.UTF-8"
  LANG: "en_US.UTF-8"

before_script:
  - unlock_ci_keychain.sh
  - gem install bundler
  - bundle install

unit_tests:
  dependencies: []
  stage: unit_tests
  artifacts:
    paths:
      - fastlane/test_output
  script:
    - get_ci_qtum_settings.sh
    - fastlane tests
  tags:
    - ios

build:
  dependencies: []
  stage: build
  environment:
   name: testnet
  artifacts:
    paths:
      - fastlane/logs
      - fastlane/build
  script:
    - get_ci_qtum_settings_testnet.sh
    - fastlane beta_testnet
  tags:
    - ios
  only:
     - /^release-.*$/
     - master